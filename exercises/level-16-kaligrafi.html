<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Level 16: Kaligrafi Aksara Sunda - Sikabayan</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap"
      rel="stylesheet"
    />

    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="../css/style.css" />

    <style>
      /* Exercise specific styles */
      .exercise-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
        padding-top: 8rem;
        min-height: 100vh;
        background: var(--bg);
      }

      .exercise-header {
        text-align: center;
        margin-bottom: 3rem;
        padding: 2rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .exercise-header h1 {
        color: var(--primary);
        font-size: 2.5rem;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;
      }

      .exercise-description {
        font-size: 1.2rem;
        color: var(--text-color);
        opacity: 0.9;
        margin-bottom: 2rem;
        line-height: 1.6;
      }

      .progress-bar {
        width: 100%;
        height: 8px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        overflow: hidden;
        margin: 1rem 0;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--primary), var(--secondary));
        width: 0%;
        transition: width 0.5s ease;
      }

      .progress-text {
        text-align: center;
        margin-top: 0.5rem;
        color: var(--text-color);
        opacity: 0.8;
      }

      .exercise-content {
        display: grid;
        gap: 2rem;
        margin-bottom: 3rem;
      }

      .exercise-section {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 1rem;
        padding: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .section-title {
        color: var(--primary);
        font-size: 1.5rem;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.8rem;
      }

      /* Kaligrafi Canvas */
      .calligraphy-practice {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        align-items: start;
      }

      .practice-canvas {
        background: white;
        border-radius: 0.5rem;
        padding: 1rem;
        min-height: 400px;
        position: relative;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .canvas-container {
        position: relative;
        width: 100%;
        height: 350px;
        border: 2px dashed #ddd;
        border-radius: 0.5rem;
        background: linear-gradient(to right, #f0f0f0 1px, transparent 1px),
          linear-gradient(to bottom, #f0f0f0 1px, transparent 1px);
        background-size: 20px 20px;
      }

      #calligraphyCanvas {
        width: 100%;
        height: 100%;
        cursor: crosshair;
        border-radius: 0.5rem;
      }

      .canvas-controls {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
        flex-wrap: wrap;
      }

      .canvas-btn {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 0.5rem;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .canvas-btn.primary {
        background: var(--primary);
        color: white;
      }

      .canvas-btn.secondary {
        background: rgba(255, 255, 255, 0.1);
        color: var(--text-color);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .canvas-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      /* Character References */
      .character-reference {
        background: rgba(255, 255, 255, 0.08);
        border-radius: 0.8rem;
        padding: 1.5rem;
      }

      .character-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
      }

      .character-card {
        background: white;
        border-radius: 0.5rem;
        padding: 1rem;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
      }

      .character-card:hover {
        transform: scale(1.05);
      }

      .character-display {
        font-size: 3rem;
        color: #2d4a78;
        margin-bottom: 0.5rem;
        font-family: "Sundanese Unicode", serif;
      }

      .character-latin {
        font-size: 1rem;
        color: #666;
        font-weight: 600;
      }

      /* Kaligrafi Tips */
      .kaligrafi-tips {
        background: linear-gradient(
          135deg,
          rgba(32, 147, 164, 0.1),
          rgba(52, 167, 184, 0.1)
        );
        border-left: 4px solid var(--primary);
      }

      .tips-list {
        list-style: none;
        padding: 0;
      }

      .tips-list li {
        padding: 0.8rem 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: flex-start;
        gap: 1rem;
      }

      .tips-list li:last-child {
        border-bottom: none;
      }

      .tip-icon {
        color: var(--primary);
        margin-top: 0.2rem;
      }

      /* Quiz Section */
      .quiz-section {
        background: linear-gradient(
          135deg,
          rgba(52, 167, 184, 0.1),
          rgba(32, 147, 164, 0.1)
        );
      }

      .question-card {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 0.8rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .question-text {
        font-size: 1.1rem;
        color: var(--text-color);
        margin-bottom: 1rem;
        font-weight: 500;
      }

      .options-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
      }

      .option {
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-radius: 0.5rem;
        padding: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
      }

      .option:hover {
        border-color: var(--primary);
        background: rgba(32, 147, 164, 0.1);
      }

      .option.selected {
        border-color: var(--primary);
        background: rgba(32, 147, 164, 0.2);
      }

      .option.correct {
        border-color: #10b981;
        background: rgba(16, 185, 129, 0.2);
      }

      .option.incorrect {
        border-color: #ef4444;
        background: rgba(239, 68, 68, 0.2);
      }

      /* Results */
      .results-section {
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.1),
          rgba(34, 197, 94, 0.1)
        );
        border-left: 4px solid #10b981;
        text-align: center;
        display: none;
      }

      .results-section.show {
        display: block;
      }

      .score-display {
        font-size: 3rem;
        color: #10b981;
        font-weight: 900;
        margin: 1rem 0;
      }

      .score-message {
        font-size: 1.2rem;
        color: var(--text-color);
        margin-bottom: 2rem;
      }

      .action-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
      }

      .btn {
        padding: 1rem 2rem;
        border: none;
        border-radius: 0.5rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn-primary {
        background: var(--primary);
        color: white;
      }

      .btn-secondary {
        background: rgba(255, 255, 255, 0.1);
        color: var(--text-color);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      }

      /* Mobile Responsiveness */
      @media (max-width: 768px) {
        .exercise-container {
          padding: 1rem;
          padding-top: 7rem;
        }

        .exercise-header h1 {
          font-size: 2rem;
          flex-direction: column;
          gap: 0.5rem;
        }

        .calligraphy-practice {
          grid-template-columns: 1fr;
        }

        .character-grid {
          grid-template-columns: repeat(3, 1fr);
        }

        .options-grid {
          grid-template-columns: 1fr;
        }

        .action-buttons {
          flex-direction: column;
          align-items: center;
        }

        .canvas-controls {
          justify-content: center;
        }
      }
    </style>
  </head>

  <body>
    <div class="exercise-container">
      <!-- Header -->
      <div class="exercise-header">
        <h1>
          <i data-feather="pen-tool"></i>
          Level 16: Kaligrafi Aksara Sunda
        </h1>
        <div class="exercise-description">
          Pelajari seni menulis indah aksara Sunda dengan teknik kaligrafi yang
          benar. Latihan ini akan mengajarkan Anda cara membuat tulisan aksara
          Sunda yang artistik dan estetis.
        </div>

        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text" id="progressText">0% Selesai</div>
      </div>

      <!-- Exercise Content -->
      <div class="exercise-content">
        <!-- Kaligrafi Practice Section -->
        <div class="exercise-section">
          <h2 class="section-title">
            <i data-feather="edit-3"></i>
            Area Latihan Kaligrafi
          </h2>

          <div class="calligraphy-practice">
            <div class="practice-canvas">
              <h3 style="color: #333; margin-bottom: 1rem">Canvas Latihan</h3>
              <div class="canvas-container">
                <canvas
                  id="calligraphyCanvas"
                  width="400"
                  height="300"
                ></canvas>
              </div>
              <div class="canvas-controls">
                <button class="canvas-btn primary" onclick="clearCanvas()">
                  <i data-feather="trash-2"></i> Bersihkan
                </button>
                <button class="canvas-btn secondary" onclick="downloadCanvas()">
                  <i data-feather="download"></i> Unduh
                </button>
                <label for="brushSize" style="color: #666; font-weight: 500"
                  >Ukuran Kuas:</label
                >
                <input
                  type="range"
                  id="brushSize"
                  min="1"
                  max="20"
                  value="3"
                  style="width: 100px"
                />
                <span id="brushSizeValue" style="color: #666">3px</span>
              </div>
            </div>

            <div class="character-reference">
              <h3 style="color: var(--text-color); margin-bottom: 1rem">
                Referensi Karakter
              </h3>
              <p
                style="
                  color: var(--text-color);
                  opacity: 0.8;
                  margin-bottom: 1rem;
                "
              >
                Klik karakter di bawah untuk melihat contoh kaligrafi yang
                benar:
              </p>
              <div class="character-grid">
                <div class="character-card" onclick="showCharacterExample('ᮃ')">
                  <div class="character-display">ᮃ</div>
                  <div class="character-latin">A</div>
                </div>
                <div class="character-card" onclick="showCharacterExample('ᮘ')">
                  <div class="character-display">ᮘ</div>
                  <div class="character-latin">BA</div>
                </div>
                <div class="character-card" onclick="showCharacterExample('ᮎ')">
                  <div class="character-display">ᮎ</div>
                  <div class="character-latin">CA</div>
                </div>
                <div class="character-card" onclick="showCharacterExample('ᮓ')">
                  <div class="character-display">ᮓ</div>
                  <div class="character-latin">DA</div>
                </div>
                <div class="character-card" onclick="showCharacterExample('ᮌ')">
                  <div class="character-display">ᮌ</div>
                  <div class="character-latin">GA</div>
                </div>
                <div class="character-card" onclick="showCharacterExample('ᮠ')">
                  <div class="character-display">ᮠ</div>
                  <div class="character-latin">HA</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Tips Section -->
        <div class="exercise-section kaligrafi-tips">
          <h2 class="section-title">
            <i data-feather="lightbulb"></i>
            Tips Kaligrafi Aksara Sunda
          </h2>

          <ul class="tips-list">
            <li>
              <i data-feather="check-circle" class="tip-icon"></i>
              <div>
                <strong>Postur yang Benar:</strong> Duduk tegak dengan kaki
                menapak lantai, jaga jarak mata ke kertas sekitar 30cm untuk
                menghindari kelelahan.
              </div>
            </li>
            <li>
              <i data-feather="check-circle" class="tip-icon"></i>
              <div>
                <strong>Genggaman Alat Tulis:</strong> Pegang pena atau kuas
                dengan rileks, jangan terlalu kencang agar tangan tidak cepat
                lelah dan goresan lebih halus.
              </div>
            </li>
            <li>
              <i data-feather="check-circle" class="tip-icon"></i>
              <div>
                <strong>Gerakan Tangan:</strong> Gunakan gerakan lengan dan
                bahu, bukan hanya pergelangan tangan untuk hasil yang lebih
                smooth dan konsisten.
              </div>
            </li>
            <li>
              <i data-feather="check-circle" class="tip-icon"></i>
              <div>
                <strong>Proporsionalitas:</strong> Jaga proporsi tinggi dan
                lebar setiap karakter agar terlihat seimbang dan mudah dibaca.
              </div>
            </li>
            <li>
              <i data-feather="check-circle" class="tip-icon"></i>
              <div>
                <strong>Konsistensi:</strong> Pertahankan ketebalan garis dan
                kemiringan yang sama di seluruh tulisan untuk hasil yang
                profesional.
              </div>
            </li>
          </ul>
        </div>

        <!-- Quiz Section -->
        <div class="exercise-section quiz-section">
          <h2 class="section-title">
            <i data-feather="help-circle"></i>
            Kuis Kaligrafi
          </h2>

          <div class="question-card">
            <div class="question-text">
              1. Apa yang paling penting dalam kaligrafi aksara Sunda?
            </div>
            <div class="options-grid">
              <div class="option" onclick="selectOption(this, false)">
                Kecepatan menulis
              </div>
              <div class="option" onclick="selectOption(this, true)">
                Konsistensi dan proporsi
              </div>
              <div class="option" onclick="selectOption(this, false)">
                Ukuran huruf yang besar
              </div>
              <div class="option" onclick="selectOption(this, false)">
                Warna tinta yang tebal
              </div>
            </div>
          </div>

          <div class="question-card">
            <div class="question-text">
              2. Bagaimana cara yang benar memegang alat tulis untuk kaligrafi?
            </div>
            <div class="options-grid">
              <div class="option" onclick="selectOption(this, false)">
                Dengan genggaman yang sangat kencang
              </div>
              <div class="option" onclick="selectOption(this, true)">
                Dengan genggaman yang rileks dan nyaman
              </div>
              <div class="option" onclick="selectOption(this, false)">
                Hanya menggunakan ujung jari
              </div>
              <div class="option" onclick="selectOption(this, false)">
                Dengan kedua tangan
              </div>
            </div>
          </div>

          <div class="question-card">
            <div class="question-text">
              3. Manakah yang merupakan teknik gerakan yang baik dalam
              kaligrafi?
            </div>
            <div class="options-grid">
              <div class="option" onclick="selectOption(this, false)">
                Hanya menggunakan pergelangan tangan
              </div>
              <div class="option" onclick="selectOption(this, true)">
                Menggunakan gerakan lengan dan bahu
              </div>
              <div class="option" onclick="selectOption(this, false)">
                Gerakan yang sangat cepat
              </div>
              <div class="option" onclick="selectOption(this, false)">
                Gerakan yang terpatah-patah
              </div>
            </div>
          </div>

          <button
            class="btn btn-primary"
            onclick="submitQuiz()"
            style="margin-top: 2rem"
          >
            <i data-feather="check"></i> Submit Kuis
          </button>
        </div>

        <!-- Results Section -->
        <div class="exercise-section results-section" id="results">
          <h2 class="section-title">
            <i data-feather="award"></i>
            Hasil Latihan
          </h2>

          <div class="score-display" id="scoreDisplay">0/3</div>
          <div class="score-message" id="scoreMessage"></div>

          <div class="action-buttons">
            <a href="../latihan.html" class="btn btn-secondary">
              <i data-feather="arrow-left"></i> Kembali ke Daftar Level
            </a>
            <a
              href="level-17-analisis-teks.html"
              class="btn btn-primary"
              id="nextLevelBtn"
              style="display: none"
            >
              <i data-feather="arrow-right"></i> Level Berikutnya
            </a>
            <button class="btn btn-primary" onclick="resetExercise()">
              <i data-feather="refresh-cw"></i> Ulangi Latihan
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Canvas setup
      const canvas = document.getElementById("calligraphyCanvas");
      const ctx = canvas.getContext("2d");
      let isDrawing = false;
      let currentBrushSize = 3;

      // Set canvas size
      canvas.width = canvas.offsetWidth;
      canvas.height = canvas.offsetHeight;

      // Drawing setup
      ctx.lineCap = "round";
      ctx.lineJoin = "round";

      // Canvas event listeners
      canvas.addEventListener("mousedown", startDrawing);
      canvas.addEventListener("mousemove", draw);
      canvas.addEventListener("mouseup", stopDrawing);
      canvas.addEventListener("mouseout", stopDrawing);

      // Touch events for mobile
      canvas.addEventListener("touchstart", handleTouch);
      canvas.addEventListener("touchmove", handleTouch);
      canvas.addEventListener("touchend", stopDrawing);

      // Brush size control
      document
        .getElementById("brushSize")
        .addEventListener("input", function (e) {
          currentBrushSize = e.target.value;
          document.getElementById("brushSizeValue").textContent =
            e.target.value + "px";
          ctx.lineWidth = currentBrushSize;
        });

      function startDrawing(e) {
        isDrawing = true;
        ctx.lineWidth = currentBrushSize;
        ctx.strokeStyle = "#2d4a78";
        ctx.beginPath();
        ctx.moveTo(getMousePos(e).x, getMousePos(e).y);
      }

      function draw(e) {
        if (!isDrawing) return;
        const pos = getMousePos(e);
        ctx.lineTo(pos.x, pos.y);
        ctx.stroke();
      }

      function stopDrawing() {
        isDrawing = false;
        ctx.beginPath();
      }

      function getMousePos(e) {
        const rect = canvas.getBoundingClientRect();
        return {
          x: e.clientX - rect.left,
          y: e.clientY - rect.top,
        };
      }

      function handleTouch(e) {
        e.preventDefault();
        const touch = e.touches[0];
        const mouseEvent = new MouseEvent(
          e.type === "touchstart"
            ? "mousedown"
            : e.type === "touchmove"
            ? "mousemove"
            : "mouseup",
          {
            clientX: touch.clientX,
            clientY: touch.clientY,
          }
        );
        canvas.dispatchEvent(mouseEvent);
      }

      function clearCanvas() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
      }

      function downloadCanvas() {
        const link = document.createElement("a");
        link.download = "kaligrafi-latihan.png";
        link.href = canvas.toDataURL();
        link.click();
      }

      function showCharacterExample(character) {
        alert(
          `Contoh kaligrafi untuk karakter: ${character}\n\nTips: Mulai dari goresan atas ke bawah, lalu kiri ke kanan untuk hasil yang terbaik.`
        );
      }

      // Quiz functionality
      let selectedAnswers = [];
      let score = 0;

      function selectOption(element, isCorrect) {
        // Remove previous selection in the same question
        const questionCard = element.closest(".question-card");
        const options = questionCard.querySelectorAll(".option");
        options.forEach((opt) => opt.classList.remove("selected"));

        // Select current option
        element.classList.add("selected");

        // Store answer
        const questionIndex = Array.from(
          document.querySelectorAll(".question-card")
        ).indexOf(questionCard);
        selectedAnswers[questionIndex] = isCorrect;
      }

      function submitQuiz() {
        // Check if all questions are answered
        if (selectedAnswers.length < 3 || selectedAnswers.includes(undefined)) {
          alert("Mohon jawab semua pertanyaan terlebih dahulu!");
          return;
        }

        // Calculate score
        score = selectedAnswers.filter((answer) => answer === true).length;

        // Show correct answers
        const questionCards = document.querySelectorAll(".question-card");
        questionCards.forEach((card, index) => {
          const options = card.querySelectorAll(".option");
          options.forEach((option) => {
            if (option.classList.contains("selected")) {
              if (selectedAnswers[index]) {
                option.classList.add("correct");
              } else {
                option.classList.add("incorrect");
              }
            }
          });
        });

        // Update progress
        updateProgress(100);

        // Show results
        showResults();

        // Save progress
        saveProgress();
      }

      function showResults() {
        const resultsSection = document.getElementById("results");
        const scoreDisplay = document.getElementById("scoreDisplay");
        const scoreMessage = document.getElementById("scoreMessage");
        const nextLevelBtn = document.getElementById("nextLevelBtn");

        scoreDisplay.textContent = `${score}/3`;

        let message = "";
        if (score === 3) {
          message =
            "🎉 Sempurna! Anda menguasai dasar-dasar kaligrafi aksara Sunda dengan sangat baik!";
          nextLevelBtn.style.display = "inline-flex";
        } else if (score === 2) {
          message =
            "👍 Bagus! Anda sudah memahami sebagian besar konsep kaligrafi aksara Sunda.";
          nextLevelBtn.style.display = "inline-flex";
        } else if (score === 1) {
          message =
            "📖 Cukup baik! Masih perlu belajar lebih banyak tentang teknik kaligrafi.";
        } else {
          message =
            "💪 Jangan menyerah! Coba pelajari lagi materi kaligrafi dan ulangi latihan.";
        }

        scoreMessage.textContent = message;
        resultsSection.classList.add("show");
        resultsSection.scrollIntoView({ behavior: "smooth" });
      }

      function updateProgress(percentage) {
        const progressFill = document.getElementById("progressFill");
        const progressText = document.getElementById("progressText");

        progressFill.style.width = percentage + "%";
        progressText.textContent = percentage + "% Selesai";
      }

      function resetExercise() {
        // Reset quiz
        selectedAnswers = [];
        score = 0;

        // Reset UI
        document.querySelectorAll(".option").forEach((option) => {
          option.classList.remove("selected", "correct", "incorrect");
        });

        document.getElementById("results").classList.remove("show");

        // Reset canvas
        clearCanvas();

        // Reset progress
        updateProgress(0);

        // Scroll to top
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function saveProgress() {
        // Save to localStorage
        const progress = {
          level: 16,
          completed: score >= 2,
          score: score,
          timestamp: new Date().toISOString(),
        };

        localStorage.setItem("level-16-progress", JSON.stringify(progress));

        // Update overall progress
        const overallProgress = JSON.parse(
          localStorage.getItem("sikabayan-progress") || "{}"
        );
        overallProgress.level16 = progress;
        localStorage.setItem(
          "sikabayan-progress",
          JSON.stringify(overallProgress)
        );
      }

      // Initialize
      document.addEventListener("DOMContentLoaded", function () {
        feather.replace();
        ctx.lineWidth = currentBrushSize;

        // Load saved progress
        const savedProgress = localStorage.getItem("level-16-progress");
        if (savedProgress) {
          const progress = JSON.parse(savedProgress);
          if (progress.completed) {
            updateProgress(100);
          }
        }
      });
    </script>
  </body>
</html>
