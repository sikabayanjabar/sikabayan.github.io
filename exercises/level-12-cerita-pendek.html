<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Level 12: Cerita Pendek - Sikabayan</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap"
      rel="stylesheet"
    />

    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="../css/style.css" />

    <style>
      /* Exercise specific styles */
      .exercise-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
        min-height: 100vh;
        background: var(--bg);
      }

      .exercise-header {
        text-align: center;
        margin-bottom: 2rem;
        padding: 2rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .exercise-header h1 {
        color: var(--text-color);
        margin-bottom: 0.5rem;
      }

      .exercise-header h1 span {
        color: var(--primary);
      }

      .level-info {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-top: 1rem;
        flex-wrap: wrap;
      }

      .info-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-color);
        opacity: 0.8;
      }

      .progress-container {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 1rem;
        padding: 1.5rem;
        margin-bottom: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .progress-bar {
        width: 100%;
        height: 8px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 0.5rem;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        width: 0%;
        transition: width 0.3s ease;
      }

      .progress-text {
        color: var(--text-color);
        text-align: center;
        font-weight: 600;
      }

      .question-card {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 1rem;
        padding: 2rem;
        margin-bottom: 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        display: none;
      }

      .question-card.active {
        display: block;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .question-number {
        color: var(--primary);
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 1rem;
      }

      .question-text {
        color: var(--text-color);
        font-size: 1.2rem;
        margin-bottom: 1.5rem;
        line-height: 1.6;
      }

      .story-container {
        background: rgba(255, 255, 255, 0.02);
        border-radius: 1rem;
        padding: 2rem;
        margin: 2rem 0;
        border: 2px solid rgba(255, 255, 255, 0.1);
      }

      .story-title {
        text-align: center;
        color: var(--primary);
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 2rem;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .story-content {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 0.8rem;
        padding: 2.5rem;
        margin-bottom: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        position: relative;
      }

      .story-content::before {
        content: '"';
        position: absolute;
        top: 10px;
        left: 20px;
        font-size: 4rem;
        color: var(--primary);
        opacity: 0.3;
        line-height: 1;
      }

      .story-content::after {
        content: '"';
        position: absolute;
        bottom: 10px;
        right: 20px;
        font-size: 4rem;
        color: var(--primary);
        opacity: 0.3;
        line-height: 1;
      }

      .story-sunda {
        font-size: 1.3rem;
        color: var(--primary);
        font-family: "Times New Roman", serif;
        line-height: 1.8;
        margin-bottom: 2rem;
        text-align: justify;
        text-indent: 2rem;
      }

      .story-latin {
        color: var(--text-color);
        font-size: 1.1rem;
        font-weight: 600;
        line-height: 1.7;
        margin-bottom: 1.5rem;
        text-align: justify;
        text-indent: 2rem;
      }

      .story-translation {
        color: var(--text-color);
        opacity: 0.8;
        font-size: 1rem;
        font-style: italic;
        line-height: 1.6;
        text-align: justify;
        text-indent: 2rem;
      }

      .story-analysis {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 0.8rem;
        padding: 2rem;
        margin: 1.5rem 0;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .analysis-title {
        color: var(--primary);
        font-weight: 700;
        margin-bottom: 1.5rem;
        font-size: 1.2rem;
        text-align: center;
      }

      .analysis-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
      }

      .analysis-item {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 0.5rem;
        padding: 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: transform 0.3s ease;
      }

      .analysis-item:hover {
        transform: translateY(-2px);
        background: rgba(255, 255, 255, 0.08);
      }

      .analysis-label {
        color: var(--primary);
        font-weight: 700;
        margin-bottom: 0.8rem;
        font-size: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .analysis-value {
        color: var(--text-color);
        font-size: 0.9rem;
        line-height: 1.5;
      }

      .story-elements {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 0.8rem;
        padding: 2rem;
        margin: 1.5rem 0;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .elements-title {
        color: var(--primary);
        font-weight: 700;
        margin-bottom: 1.5rem;
        font-size: 1.2rem;
        text-align: center;
      }

      .elements-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
      }

      .element-item {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 0.3rem;
        padding: 1rem;
        border-left: 4px solid var(--primary);
      }

      .element-name {
        color: var(--primary);
        font-weight: 600;
        margin-bottom: 0.5rem;
      }

      .element-description {
        color: var(--text-color);
        font-size: 0.9rem;
        line-height: 1.4;
      }

      .comprehension-section {
        background: rgba(255, 255, 255, 0.02);
        border-radius: 0.8rem;
        padding: 2rem;
        margin: 2rem 0;
        border: 2px dashed rgba(255, 255, 255, 0.2);
      }

      .comprehension-title {
        text-align: center;
        color: var(--primary);
        font-weight: 700;
        margin-bottom: 1.5rem;
        font-size: 1.3rem;
      }

      .story-questions {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 0.5rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .question-prompt {
        color: var(--text-color);
        font-weight: 600;
        margin-bottom: 1rem;
        font-size: 1.1rem;
      }

      .options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1rem;
        margin: 2rem 0;
      }

      .option {
        padding: 1.5rem;
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-radius: 0.8rem;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: left;
        position: relative;
      }

      .option:hover {
        border-color: var(--primary);
        background: rgba(32, 147, 164, 0.1);
        transform: translateY(-2px);
      }

      .option.selected {
        border-color: var(--primary);
        background: rgba(32, 147, 164, 0.2);
      }

      .option.correct {
        border-color: #10b981;
        background: rgba(16, 185, 129, 0.2);
        color: #10b981;
      }

      .option.incorrect {
        border-color: #ef4444;
        background: rgba(239, 68, 68, 0.2);
        color: #ef4444;
      }

      .option-content {
        color: var(--text-color);
        font-weight: 600;
        line-height: 1.5;
      }

      .option-number {
        position: absolute;
        top: -10px;
        left: 15px;
        background: var(--primary);
        color: white;
        width: 25px;
        height: 25px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
        font-weight: bold;
      }

      .controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 2rem;
      }

      .btn {
        padding: 0.8rem 2rem;
        border: none;
        border-radius: 0.5rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn-primary {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(32, 147, 164, 0.4);
      }

      .btn-secondary {
        background: rgba(255, 255, 255, 0.1);
        color: var(--text-color);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .btn-secondary:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .feedback {
        margin-top: 1rem;
        padding: 1rem;
        border-radius: 0.5rem;
        display: none;
      }

      .feedback.correct {
        background: rgba(16, 185, 129, 0.1);
        border: 1px solid #10b981;
        color: #10b981;
      }

      .feedback.incorrect {
        background: rgba(239, 68, 68, 0.1);
        border: 1px solid #ef4444;
        color: #ef4444;
      }

      .result-screen {
        display: none;
        text-align: center;
      }

      .result-screen.show {
        display: block;
      }

      .score-display {
        font-size: 3rem;
        font-weight: 700;
        color: var(--primary);
        margin: 1rem 0;
      }

      .result-message {
        font-size: 1.2rem;
        color: var(--text-color);
        margin-bottom: 2rem;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 1rem;
        margin: 2rem 0;
      }

      .stat-item {
        background: rgba(255, 255, 255, 0.05);
        padding: 1rem;
        border-radius: 0.5rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .stat-number {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--primary);
        margin-bottom: 0.5rem;
      }

      .stat-label {
        color: var(--text-color);
        opacity: 0.8;
        font-size: 0.9rem;
      }

      /* Mobile responsiveness */
      @media (max-width: 768px) {
        .exercise-container {
          padding: 1rem;
        }

        .level-info {
          gap: 1rem;
        }

        .story-sunda {
          font-size: 1.1rem;
        }

        .analysis-grid {
          grid-template-columns: 1fr;
        }

        .elements-list {
          grid-template-columns: 1fr;
        }

        .controls {
          flex-direction: column;
          gap: 1rem;
        }

        .options {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="exercise-container">
      <!-- Exercise Header -->
      <div class="exercise-header">
        <h1><span>Level 12:</span> Cerita Pendek Aksara Sunda</h1>
        <p>Latihan membaca dan memahami cerita pendek dalam aksara Sunda</p>
        <div class="level-info">
          <div class="info-item">
            <i data-feather="target"></i>
            <span>Target: 80% untuk lulus</span>
          </div>
          <div class="info-item">
            <i data-feather="clock"></i>
            <span>Waktu: ~40 menit</span>
          </div>
          <div class="info-item">
            <i data-feather="book"></i>
            <span>6 Soal</span>
          </div>
        </div>
      </div>

      <!-- Progress Bar -->
      <div class="progress-container">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text" id="progressText">Soal 1 dari 6</div>
      </div>

      <!-- Quiz Container -->
      <div id="quizContainer">
        <!-- Questions will be generated by JavaScript -->
      </div>

      <!-- Result Screen -->
      <div class="result-screen" id="resultScreen">
        <div class="question-card">
          <h2>🎉 Level 12 Selesai!</h2>
          <div class="score-display" id="finalScore">85/100</div>
          <div class="result-message" id="resultMessage">
            Excellent! Anda sudah mampu memahami cerita pendek dalam aksara
            Sunda dengan baik.
          </div>

          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-number" id="correctAnswers">5</div>
              <div class="stat-label">Jawaban Benar</div>
            </div>
            <div class="stat-item">
              <div class="stat-number" id="incorrectAnswers">1</div>
              <div class="stat-label">Jawaban Salah</div>
            </div>
            <div class="stat-item">
              <div class="stat-number" id="timeTaken">38:20</div>
              <div class="stat-label">Waktu</div>
            </div>
            <div class="stat-item">
              <div class="stat-number" id="accuracy">85%</div>
              <div class="stat-label">Akurasi</div>
            </div>
          </div>

          <div class="controls">
            <button
              class="btn btn-secondary"
              onclick="window.location.href='../latihan.html'"
            >
              <i data-feather="arrow-left"></i> Kembali ke Menu
            </button>
            <button class="btn btn-primary" onclick="nextLevel()">
              Level Selanjutnya <i data-feather="arrow-right"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Quiz data
      const quizData = [
        {
          question: "Bacalah cerita pendek berikut dan pahami isi ceritanya:",
          type: "story_comprehension",
          story: {
            title: "Budak nu Rajin",
            sunda:
              "ᮞᮤ ᮄᮔ ᮔᮙ ᮘᮥᮓᮊ᮪ ᮔᮥ ᮛᮏᮤᮔ. ᮞᮤ ᮄᮔ ᮞᮥᮊ ᮔᮧᮀ ᮞᮊᮧᮜᮂ. ᮞᮤ ᮄᮔ ᮞᮦᮔᮔ ᮒᮅ ᮞᮊᮧᮜᮂ. ᮞᮤ ᮄᮔ ᮙᮎ ᮘᮥᮊᮥ ᮞᮔᮒᮛᮤ. ᮄᮔ ᮞᮇᮞᮔ ᮃᮔᮊ᮪ ᮞᮇᮞᮔ. ᮌᮥᮛᮥᮔ ᮞᮇᮞᮔ ᮞᮤ ᮄᮔ. ᮌᮥᮛᮥᮔ ᮃᮞᮧᮀ ᮃᮔᮊ᮪ ᮛᮏᮤᮔ. ᮞᮤ ᮄᮔ ᮘᮃᮘᮌᮦᮃ ᮏᮝᮘᮔ ᮘᮩ ᮌᮥᮛᮥ.",
            latin:
              "Si En nami budak nu rajin. Si En suka nong sakola. Si En sengan tos sakola. Si En maca buku santari. En surusan anak surusan. Gurun surusan si En. Gurun asong anak rajin. Si En bade bageah jawaban bu guru.",
            translation:
              "Si En namanya anak yang rajin. Si En suka pergi ke sekolah. Si En selalu berangkat ke sekolah. Si En membaca buku sepanjang hari. En adalah anak yang pintar. Guru menyayangi si En. Guru senang dengan anak yang rajin. Si En akan mendapat hadiah dari bu guru.",
          },
          elements: {
            "Tokoh Utama": "Si En - anak yang rajin",
            Karakter: "Rajin, suka belajar, pintar",
            Setting: "Sekolah dan aktivitas belajar",
            Tema: "Pentingnya rajin belajar",
            "Pesan Moral": "Kerajinan akan mendapat penghargaan",
          },
          options: [
            {
              content:
                "Cerita tentang anak rajin yang gemar belajar dan mendapat penghargaan",
              correct: true,
            },
            {
              content: "Cerita tentang anak yang malas dan tidak suka sekolah",
              correct: false,
            },
            {
              content:
                "Cerita tentang guru yang galak dan tidak menyukai murid",
              correct: false,
            },
            {
              content: "Cerita tentang anak yang selalu terlambat ke sekolah",
              correct: false,
            },
          ],
          explanation:
            "Cerita menceritakan Si En yang rajin belajar, suka ke sekolah, dan akhirnya mendapat penghargaan dari guru.",
        },
        {
          question:
            "Berdasarkan cerita di atas, apa karakteristik utama tokoh Si En?",
          type: "character_analysis",
          characteristics: [
            "Rajin ke sekolah",
            "Suka membaca buku",
            "Anak yang pintar",
            "Disukai guru",
            "Akan mendapat hadiah",
          ],
          options: [
            {
              content:
                "Si En adalah anak yang rajin, suka belajar, dan berprestasi",
              correct: true,
            },
            {
              content:
                "Si En adalah anak yang nakal dan sering membuat masalah",
              correct: false,
            },
            {
              content: "Si En adalah anak yang pemalu dan tidak percaya diri",
              correct: false,
            },
            {
              content: "Si En adalah anak yang pemalas dan tidak suka belajar",
              correct: false,
            },
          ],
          explanation:
            "Dari cerita terlihat Si En memiliki karakter rajin, gemar belajar, dan berprestasi sehingga disayang guru.",
        },
        {
          question: "Bacalah cerita kedua berikut:",
          type: "story_comprehension_2",
          story: {
            title: "Kebon Kembang",
            sunda:
              "ᮞᮤ ᮃᮔᮤ ᮌᮠᮥ ᮊᮦᮘᮧᮔ ᮊᮦᮙᮘᮀ. ᮊᮦᮘᮧᮔ ᮞᮤ ᮃᮔᮤ ᮞᮀᮒ ᮌᮦᮌᮉ. ᮊᮦᮙᮘᮀ ᮔᮩ ᮞᮤ ᮃᮔᮤ ᮘᮦᮔᮨᮛ ᮘᮦᮔᮨᮛ. ᮞᮤ ᮃᮔᮤ ᮔᮚᮞᮤ ᮘᮦᮔᮨᮛ ᮞᮤᮔᮔ ᮞᮇᮛᮦ. ᮞᮤ ᮃᮔᮤ ᮔᮨᮔᮨᮛ ᮊᮦᮙᮘᮀ ᮏᮥᮀ ᮞᮝ. ᮊᮦᮙᮘᮀ ᮞᮤ ᮃᮔᮤ ᮃᮚ ᮔᮥ ᮛᮏᮤᮔ ᮙᮦᮊᮁ. ᮞᮇᮛᮦ ᮘᮨᮜᮤ ᮊᮦᮙᮘᮀ ᮞᮤ ᮃᮔᮤ.",
            latin:
              "Si Ani geus kebon kembang. Kebon si Ani seang gede. Kembang nu si Ani bener bener. Si Ani nyaur bener sintan sore. Si Ani naner kembang jung saw. Kembang si Ani aya nu rajin mekar. Sore beli kembang si Ani.",
            translation:
              "Si Ani sudah punya kebun bunga. Kebun si Ani sangat besar. Bunga yang ditanam si Ani indah-indah. Si Ani menyiram bunga setiap pagi dan sore. Si Ani menanam bunga yang beragam. Bunga si Ani ada yang rajin mekar. Sore hari orang membeli bunga si Ani.",
          },
          analysis: {
            Setting: "Kebun bunga milik Si Ani",
            Aktivitas: "Menanam, merawat, dan menjual bunga",
            Hasil: "Bunga tumbuh indah dan laku dijual",
            Karakter: "Rajin, tekun, dan bertanggung jawab",
          },
          options: [
            {
              content:
                "Cerita tentang Si Ani yang rajin merawat kebun bunga hingga berhasil",
              correct: true,
            },
            {
              content: "Cerita tentang Si Ani yang gagal menanam bunga",
              correct: false,
            },
            {
              content: "Cerita tentang Si Ani yang malas merawat kebun",
              correct: false,
            },
            {
              content:
                "Cerita tentang Si Ani yang hanya suka memetik bunga orang lain",
              correct: false,
            },
          ],
          explanation:
            "Cerita menggambarkan Si Ani yang tekun merawat kebun bunga hingga berhasil dan bunganya laku dijual.",
        },
        {
          question: "Apa tema utama yang menghubungkan kedua cerita tersebut?",
          type: "theme_analysis",
          comparison: {
            "Cerita 1": "Si En yang rajin belajar",
            "Cerita 2": "Si Ani yang rajin berkebun",
            Kesamaan: "Keduanya menunjukkan pentingnya kerajinan",
            Hasil: "Keduanya mendapat hasil positif dari usaha mereka",
          },
          options: [
            {
              content:
                "Tema utama adalah pentingnya kerajinan dan ketekunan dalam mencapai keberhasilan",
              correct: true,
            },
            {
              content:
                "Tema utama adalah persaingan antara anak-anak dalam belajar",
              correct: false,
            },
            {
              content:
                "Tema utama adalah pentingnya kekayaan dan materi dalam hidup",
              correct: false,
            },
            {
              content:
                "Tema utama adalah perbedaan gender dalam aktivitas sehari-hari",
              correct: false,
            },
          ],
          explanation:
            "Kedua cerita sama-sama menekankan nilai kerajinan dan ketekunan yang menghasilkan pencapaian positif.",
        },
        {
          question:
            "Analisis nilai-nilai moral yang terkandung dalam kedua cerita:",
          type: "moral_analysis",
          morals: [
            "Kerajinan akan membuahkan hasil",
            "Ketekunan dalam belajar penting untuk masa depan",
            "Merawat tanaman mengajarkan tanggung jawab",
            "Usaha yang sungguh-sungguh tidak akan sia-sia",
            "Apresiasi dari orang lain didapat melalui prestasi",
          ],
          options: [
            {
              content:
                "Kedua cerita mengajarkan bahwa kerja keras dan ketekunan akan membuahkan hasil yang baik",
              correct: true,
            },
            {
              content:
                "Kedua cerita mengajarkan bahwa keberuntungan lebih penting daripada usaha",
              correct: false,
            },
            {
              content:
                "Kedua cerita mengajarkan bahwa persaingan adalah hal yang negatif",
              correct: false,
            },
            {
              content: "Kedua cerita tidak memiliki nilai moral yang jelas",
              correct: false,
            },
          ],
          explanation:
            "Nilai moral utama adalah kerja keras, ketekunan, dan tanggung jawab yang menghasilkan pencapaian positif.",
        },
        {
          question:
            "Berdasarkan pemahaman Anda terhadap kedua cerita, manakah kesimpulan yang paling tepat?",
          type: "conclusion",
          synthesis:
            "Kedua cerita pendek ini merupakan contoh sastra Sunda yang mengandung nilai-nilai pendidikan karakter, khususnya dalam mengajarkan pentingnya kerajinan, ketekunan, dan tanggung jawab dalam kehidupan sehari-hari.",
          literaryValue: {
            Bahasa: "Menggunakan bahasa Sunda yang sederhana namun bermakna",
            Struktur: "Alur cerita yang jelas dan mudah dipahami",
            Karakter: "Tokoh yang memiliki sifat positif sebagai teladan",
            Pesan: "Nilai moral yang relevan dengan kehidupan sehari-hari",
          },
          options: [
            {
              content:
                "Cerita-cerita ini efektif dalam menyampaikan nilai pendidikan melalui contoh konkret dalam kehidupan sehari-hari",
              correct: true,
            },
            {
              content:
                "Cerita-cerita ini terlalu sederhana dan tidak memiliki nilai sastra yang tinggi",
              correct: false,
            },
            {
              content:
                "Cerita-cerita ini hanya cocok untuk anak kecil dan tidak relevan untuk remaja",
              correct: false,
            },
            {
              content:
                "Cerita-cerita ini tidak mencerminkan budaya Sunda yang sesungguhnya",
              correct: false,
            },
          ],
          explanation:
            "Cerita-cerita ini berhasil menyampaikan nilai pendidikan karakter melalui contoh nyata yang mudah dipahami dan diaplikasikan.",
        },
      ];

      let currentQuestion = 0;
      let score = 0;
      let userAnswers = [];
      let startTime = Date.now();

      function initializeQuiz() {
        generateQuizHTML();
        showQuestion(0);
        updateProgress();
      }

      function generateQuizHTML() {
        const container = document.getElementById("quizContainer");
        container.innerHTML = "";

        quizData.forEach((question, index) => {
          let questionHTML = `
                    <div class="question-card" id="question-${index}">
                        <div class="question-number">Soal ${index + 1} dari ${
            quizData.length
          }</div>
                        <div class="question-text">${question.question}</div>
                `;

          // Story comprehension
          if (
            question.type === "story_comprehension" ||
            question.type === "story_comprehension_2"
          ) {
            questionHTML += `
                        <div class="story-container">
                            <div class="story-title">${
                              question.story.title
                            }</div>
                            <div class="story-content">
                                <div class="story-sunda">${
                                  question.story.sunda
                                }</div>
                                <div class="story-latin">${
                                  question.story.latin
                                }</div>
                                <div class="story-translation">${
                                  question.story.translation
                                }</div>
                            </div>
                            ${
                              question.elements
                                ? `
                                <div class="story-analysis">
                                    <div class="analysis-title"><i data-feather="book-open"></i> Analisis Cerita</div>
                                    <div class="analysis-grid">
                                        ${Object.entries(question.elements)
                                          .map(
                                            ([key, value]) => `
                                            <div class="analysis-item">
                                                <div class="analysis-label">${key}:</div>
                                                <div class="analysis-value">${value}</div>
                                            </div>
                                        `
                                          )
                                          .join("")}
                                    </div>
                                </div>
                            `
                                : ""
                            }
                            ${
                              question.analysis
                                ? `
                                <div class="story-analysis">
                                    <div class="analysis-title"><i data-feather="search"></i> Analisis Cerita</div>
                                    <div class="analysis-grid">
                                        ${Object.entries(question.analysis)
                                          .map(
                                            ([key, value]) => `
                                            <div class="analysis-item">
                                                <div class="analysis-label">${key}:</div>
                                                <div class="analysis-value">${value}</div>
                                            </div>
                                        `
                                          )
                                          .join("")}
                                    </div>
                                </div>
                            `
                                : ""
                            }
                        </div>
                    `;
          }

          // Character analysis
          if (question.type === "character_analysis") {
            questionHTML += `
                        <div class="story-elements">
                            <div class="elements-title"><i data-feather="user"></i> Karakteristik Si En</div>
                            <div class="elements-list">
                                ${question.characteristics
                                  .map(
                                    (char, charIndex) => `
                                    <div class="element-item">
                                        <div class="element-name">Karakteristik ${
                                          charIndex + 1
                                        }</div>
                                        <div class="element-description">${char}</div>
                                    </div>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>
                    `;
          }

          // Theme analysis
          if (question.type === "theme_analysis") {
            questionHTML += `
                        <div class="story-analysis">
                            <div class="analysis-title"><i data-feather="layers"></i> Perbandingan Cerita</div>
                            <div class="analysis-grid">
                                ${Object.entries(question.comparison)
                                  .map(
                                    ([key, value]) => `
                                    <div class="analysis-item">
                                        <div class="analysis-label">${key}:</div>
                                        <div class="analysis-value">${value}</div>
                                    </div>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>
                    `;
          }

          // Moral analysis
          if (question.type === "moral_analysis") {
            questionHTML += `
                        <div class="story-elements">
                            <div class="elements-title"><i data-feather="heart"></i> Nilai-Nilai Moral</div>
                            <div class="elements-list">
                                ${question.morals
                                  .map(
                                    (moral, moralIndex) => `
                                    <div class="element-item">
                                        <div class="element-name">Nilai ${
                                          moralIndex + 1
                                        }</div>
                                        <div class="element-description">${moral}</div>
                                    </div>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>
                    `;
          }

          // Conclusion
          if (question.type === "conclusion") {
            questionHTML += `
                        <div class="comprehension-section">
                            <div class="comprehension-title"><i data-feather="lightbulb"></i> Sintesis Pembelajaran</div>
                            <div class="story-questions">
                                <div class="question-prompt">Ringkasan:</div>
                                <div style="color: var(--text-color); line-height: 1.6; margin-bottom: 1rem;">${
                                  question.synthesis
                                }</div>
                            </div>
                            <div class="story-analysis">
                                <div class="analysis-title">Nilai Sastra</div>
                                <div class="analysis-grid">
                                    ${Object.entries(question.literaryValue)
                                      .map(
                                        ([key, value]) => `
                                        <div class="analysis-item">
                                            <div class="analysis-label">${key}:</div>
                                            <div class="analysis-value">${value}</div>
                                        </div>
                                    `
                                      )
                                      .join("")}
                                </div>
                            </div>
                        </div>
                    `;
          }

          // Options
          questionHTML += `
                    <div class="options" id="options-${index}">
                        ${question.options
                          .map(
                            (option, optionIndex) => `
                            <div class="option" onclick="selectAnswer(${index}, ${optionIndex})">
                                <div class="option-number">${String.fromCharCode(
                                  65 + optionIndex
                                )}</div>
                                <div class="option-content">${
                                  option.content
                                }</div>
                            </div>
                        `
                          )
                          .join("")}
                    </div>
                `;

          questionHTML += `
                        <div class="feedback" id="feedback-${index}"></div>
                        
                        <div class="controls">
                            <button class="btn btn-secondary" onclick="previousQuestion()" ${
                              index === 0 ? 'style="visibility: hidden"' : ""
                            }>
                                <i data-feather="arrow-left"></i> Sebelumnya
                            </button>
                            <button class="btn btn-primary" id="nextBtn-${index}" onclick="nextQuestion()" disabled>
                                ${
                                  index === quizData.length - 1
                                    ? "Selesai"
                                    : "Selanjutnya"
                                } 
                                <i data-feather="arrow-right"></i>
                            </button>
                        </div>
                    </div>
                `;

          container.innerHTML += questionHTML;
        });
      }

      function selectAnswer(questionIndex, answerIndex) {
        const options = document.querySelectorAll(
          `#options-${questionIndex} .option`
        );
        const question = quizData[questionIndex];

        // Remove previous selections
        options.forEach((option) => {
          option.classList.remove("selected", "correct", "incorrect");
        });

        // Mark selected answer
        options[answerIndex].classList.add("selected");

        // Store user answer
        userAnswers[questionIndex] = answerIndex;

        // Check if correct
        const isCorrect = question.options[answerIndex].correct;

        if (isCorrect) {
          options[answerIndex].classList.add("correct");
          score += Math.round(100 / quizData.length);
          showFeedback(
            questionIndex,
            "correct",
            "✓ Benar! " + question.explanation
          );
        } else {
          options[answerIndex].classList.add("incorrect");
          // Show correct answer
          question.options.forEach((option, index) => {
            if (option.correct) {
              options[index].classList.add("correct");
            }
          });
          showFeedback(
            questionIndex,
            "incorrect",
            "✗ Salah. " + question.explanation
          );
        }

        // Enable next button
        document.getElementById(`nextBtn-${questionIndex}`).disabled = false;
      }

      function showFeedback(questionIndex, type, message) {
        const feedback = document.getElementById(`feedback-${questionIndex}`);
        feedback.className = `feedback ${type}`;
        feedback.innerHTML = message;
        feedback.style.display = "block";
      }

      function showQuestion(index) {
        // Hide all questions
        document.querySelectorAll(".question-card").forEach((card) => {
          card.classList.remove("active");
        });

        // Show current question
        document.getElementById(`question-${index}`).classList.add("active");

        // Update progress
        updateProgress();

        // Re-initialize feather icons
        feather.replace();
      }

      function nextQuestion() {
        if (currentQuestion < quizData.length - 1) {
          currentQuestion++;
          showQuestion(currentQuestion);
        } else {
          showResults();
        }
      }

      function previousQuestion() {
        if (currentQuestion > 0) {
          currentQuestion--;
          showQuestion(currentQuestion);
        }
      }

      function updateProgress() {
        const progress = (currentQuestion / quizData.length) * 100;
        document.getElementById("progressFill").style.width = progress + "%";
        document.getElementById("progressText").textContent = `Soal ${
          currentQuestion + 1
        } dari ${quizData.length}`;
      }

      function showResults() {
        const endTime = Date.now();
        const timeTaken = Math.floor((endTime - startTime) / 1000);
        const minutes = Math.floor(timeTaken / 60);
        const seconds = timeTaken % 60;

        const correctCount = Math.round(score / (100 / quizData.length));
        const incorrectCount = quizData.length - correctCount;

        // Hide quiz container
        document.getElementById("quizContainer").style.display = "none";
        document.querySelector(".progress-container").style.display = "none";

        // Show results
        document.getElementById("resultScreen").classList.add("show");
        document.getElementById("finalScore").textContent = score + "/100";
        document.getElementById("correctAnswers").textContent = correctCount;
        document.getElementById("incorrectAnswers").textContent =
          incorrectCount;
        document.getElementById("timeTaken").textContent = `${minutes}:${seconds
          .toString()
          .padStart(2, "0")}`;
        document.getElementById("accuracy").textContent = score + "%";

        // Update result message
        let message = "";
        if (score >= 90) {
          message =
            "🌟 Luar biasa! Anda sangat mahir memahami cerita dalam aksara Sunda!";
        } else if (score >= 80) {
          message =
            "👏 Excellent! Anda sudah mampu menganalisis cerita dengan baik.";
        } else if (score >= 70) {
          message =
            "👍 Bagus! Terus berlatih memahami cerita yang lebih kompleks.";
        } else {
          message =
            "💪 Jangan menyerah! Latihan membaca cerita akan meningkatkan pemahaman Anda.";
        }

        document.getElementById("resultMessage").textContent = message;

        // Re-initialize feather icons
        feather.replace();
      }

      function nextLevel() {
        window.location.href = "level-13-puisi.html";
      }

      // Initialize quiz when page loads
      document.addEventListener("DOMContentLoaded", function () {
        initializeQuiz();
        feather.replace();
      });
    </script>
  </body>
</html>
